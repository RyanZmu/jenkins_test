pipeline {
    agent any

    stages {

        stage('Clone') {
            steps {
                echo 'Build Stage'
                git branch: 'main', url: 'git@github.com:RyanZmu/jenkins_test.git'
            }
        }
             stage('ssh') {
          sshagent(credentials: ['vagrant']) {
            sh '''
                [ -d ~/.ssh ] || mkdir ~/.ssh && chmod 0700 ~/.ssh
                ssh-keyscan -t rsa,dsa 192.168.60.8 >> ~/.ssh/known_hosts
                ssh vagrant@192.168.60.8 ...
            '''
          }
      }
        stage('Set-up Node Environment') {
            steps {
                echo 'Test Stage'
                sh '''ansible-playbook /var/lib/jenkins/workspace/Test_Pipeline/playbooks/node_setup.yml -vvv'''
            }
        }
        stage('Deploy') {
            steps {
                echo 'Deploy Stage'
            }
        }
    }
}
// This is just testing; will break out app deploy tasks from node_setup so we can have a seperate stage